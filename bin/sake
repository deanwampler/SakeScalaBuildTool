#!/bin/sh -- 

CLASSPATH=/Library/tools/scala/scala-specs/specs-1.4.1.jar:build
set +x
file=sake.scala
args[0]=-cp
args[1]=$CLASSPATH

while [ $# -gt 0 ]
do
	case $1 in
		-f)
			shift
			file=$1
			;;
		-*)
			args[${#args[@]}]=$1
			shift
			args[${#args[@]}]=$1
			;;
		*)
			targets[${#targets[@]}]=$1
			;;
	esac
	shift
done

if [ "${#targets[@]}" == 0 ]; then
    targets[0]="all"
fi

( cat $file; \
  echo "project.build(\"${targets[@]}\")"
) |  scala "${args[@]}"

# scala "${args[@]}" <<-EOF
#     :load "$file"
#     build
# EOF
